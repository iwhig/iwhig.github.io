<!DOCTYPE HTML>
<html lang="zh-CN">


<head>
    <meta charset="utf-8">
    <meta name="keywords" content="K8S配置管理 ConfigMap和Sercret, IW&#39;S BLOG">
    <meta name="description" content="K8S配置管理 ConfigMap和Sercret，两种资源的简单介绍及使用">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="referrer" content="no-referrer-when-downgrade">
    <!-- Global site tag (gtag.js) - Google Analytics -->


    <title>K8S配置管理 ConfigMap和Sercret | IW&#39;S BLOG</title>
    <link rel="icon" type="image/png" href="/favicon.png">
    


    <!-- bg-cover style     -->



<link rel="stylesheet" type="text/css" href="/libs/awesome/css/all.min.css">
<link rel="stylesheet" type="text/css" href="/libs/materialize/materialize.min.css">
<link rel="stylesheet" type="text/css" href="/libs/aos/aos.css">
<link rel="stylesheet" type="text/css" href="/libs/animate/animate.min.css">
<link rel="stylesheet" type="text/css" href="/libs/lightGallery/css/lightgallery.min.css">
<link rel="stylesheet" type="text/css" href="/css/matery.css">
<link rel="stylesheet" type="text/css" href="/css/my.css">
<link rel="stylesheet" type="text/css" href="/css/dark.css" media="none" onload="if(media!='all')media='all'">




    <link rel="stylesheet" href="/libs/tocbot/tocbot.css">
    <link rel="stylesheet" href="/css/post.css">




    



    <script src="/libs/jquery/jquery-3.6.0.min.js"></script>

<meta name="generator" content="Hexo 6.3.0">
<style>.github-emoji { position: relative; display: inline-block; width: 1.2em; min-height: 1.2em; overflow: hidden; vertical-align: top; color: transparent; }  .github-emoji > span { position: relative; z-index: 10; }  .github-emoji img, .github-emoji .fancybox { margin: 0 !important; padding: 0 !important; border: none !important; outline: none !important; text-decoration: none !important; user-select: none !important; cursor: auto !important; }  .github-emoji img { height: 1.2em !important; width: 1.2em !important; position: absolute !important; left: 50% !important; top: 50% !important; transform: translate(-50%, -50%) !important; user-select: none !important; cursor: auto !important; } .github-emoji-fallback { color: inherit; } .github-emoji-fallback img { opacity: 0 !important; }</style>
</head>


<body>
    <header class="navbar-fixed">
    <nav id="headNav" class="bg-color nav-transparent">
        <div id="navContainer" class="nav-wrapper container">
            <div class="brand-logo">
                <a href="/" class="waves-effect waves-light">
                    
                    <img src="/medias/logo.png" class="logo-img" alt="LOGO">
                    
                    <span class="logo-span">IW&#39;S BLOG</span>
                </a>
            </div>
            

<a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fas fa-bars"></i></a>
<ul class="right nav-menu">
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="https://iwhig.github.io/" class="waves-effect waves-light">
      
      <i class="fas fa-home" style="zoom: 0.6;"></i>
      
      <span>首页</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/tags" class="waves-effect waves-light">
      
      <i class="fas fa-tags" style="zoom: 0.6;"></i>
      
      <span>标签</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/categories" class="waves-effect waves-light">
      
      <i class="fas fa-bookmark" style="zoom: 0.6;"></i>
      
      <span>分类</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/archives" class="waves-effect waves-light">
      
      <i class="fas fa-archive" style="zoom: 0.6;"></i>
      
      <span>归档</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/about" class="waves-effect waves-light">
      
      <i class="fas fa-user-circle" style="zoom: 0.6;"></i>
      
      <span>关于</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/contact" class="waves-effect waves-light">
      
      <i class="fas fa-comments" style="zoom: 0.6;"></i>
      
      <span>留言板</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/friends" class="waves-effect waves-light">
      
      <i class="fas fa-address-book" style="zoom: 0.6;"></i>
      
      <span>友情链接</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a target="_blank" rel="noopener" href="https://cloudzzjm-my.sharepoint.com/" class="waves-effect waves-light">
      
      <i class="far fa-hdd" style="zoom: 0.6;"></i>
      
      <span>Cloud</span>
    </a>
    
  </li>
  
  <li>
    <a href="#searchModal" class="modal-trigger waves-effect waves-light">
      <i id="searchIcon" class="fas fa-search" title="搜索" style="zoom: 0.85;"></i>
    </a>
  </li>
  <li>
    <a href="javascript:;" class="waves-effect waves-light" onclick="switchNightMode()" title="深色/浅色模式" >
      <i id="sum-moon-icon" class="fas fa-sun" style="zoom: 0.85;"></i>
    </a>
  </li>
</ul>


<div id="mobile-nav" class="side-nav sidenav">

    <div class="mobile-head bg-color">
        
        <img src="/medias/logo.png" class="logo-img circle responsive-img">
        
        <div class="logo-name">IW&#39;S BLOG</div>
        <div class="logo-desc">
            
            当你的能力还驾驭不了你的目标时，就应该沉下心来，历练
            
        </div>
    </div>

    <ul class="menu-list mobile-menu-list">
        
        <li class="m-nav-item">
	  
		<a href="https://iwhig.github.io/" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-home"></i>
			
			首页
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/tags" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-tags"></i>
			
			标签
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/categories" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-bookmark"></i>
			
			分类
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/archives" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-archive"></i>
			
			归档
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/about" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-user-circle"></i>
			
			关于
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/contact" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-comments"></i>
			
			留言板
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/friends" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-address-book"></i>
			
			友情链接
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a target="_blank" rel="noopener" href="https://cloudzzjm-my.sharepoint.com/" class="waves-effect waves-light">
			
			    <i class="fa-fw far fa-hdd"></i>
			
			Cloud
		</a>
          
        </li>
        
        
    </ul>
</div>


        </div>

        
    </nav>

</header>

    
<script src="/libs/cryptojs/crypto-js.min.js"></script>
<script>
    (function() {
        let pwd = '';
        if (pwd && pwd.length > 0) {
            if (pwd !== CryptoJS.SHA256(prompt('请输入访问本文章的密码')).toString(CryptoJS.enc.Hex)) {
                alert('密码错误，将返回主页！');
                location.href = '/';
            }
        }
    })();
</script>




<div class="bg-cover pd-header post-cover" style="background-image: url('/medias/featureimages/0.jpg')">
    <div class="container" style="right: 0px;left: 0px;">
        <div class="row">
            <div class="col s12 m12 l12">
                <div class="brand">
                    <h1 class="description center-align post-title">K8S配置管理 ConfigMap和Sercret</h1>
                </div>
            </div>
        </div>
    </div>
</div>




<main class="post-container content">

    
    <div class="row">
    <div id="main-content" class="col s12 m12 l9">
        <!-- 文章内容详情 -->
<div id="artDetail">
    <div class="card">
        <div class="card-content article-info">
            <div class="row tag-cate">
                <div class="col s7">
                    
                    <div class="article-tag">
                        
                            <a href="/tags/Linux/">
                                <span class="chip bg-color">Linux</span>
                            </a>
                        
                            <a href="/tags/Shell/">
                                <span class="chip bg-color">Shell</span>
                            </a>
                        
                            <a href="/tags/Kubernetes/">
                                <span class="chip bg-color">Kubernetes</span>
                            </a>
                        
                    </div>
                    
                </div>
                <div class="col s5 right-align">
                    
                    <div class="post-cate">
                        <i class="fas fa-bookmark fa-fw icon-category"></i>
                        
                            <a href="/categories/K8s/" class="post-category">
                                K8s
                            </a>
                        
                    </div>
                    
                </div>
            </div>

            <div class="post-info">
                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-minus fa-fw"></i>发布日期:&nbsp;&nbsp;
                    2024-03-05
                </div>
                

                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-check fa-fw"></i>更新日期:&nbsp;&nbsp;
                    2024-03-11
                </div>
                

                
                <div class="info-break-policy">
                    <i class="far fa-file-word fa-fw"></i>文章字数:&nbsp;&nbsp;
                    2.2k
                </div>
                

                
                <div class="info-break-policy">
                    <i class="far fa-clock fa-fw"></i>阅读时长:&nbsp;&nbsp;
                    9 分
                </div>
                

                
                    <div id="busuanzi_container_page_pv" class="info-break-policy">
                        <i class="far fa-eye fa-fw"></i>阅读次数:&nbsp;&nbsp;
                        <span id="busuanzi_value_page_pv"></span>
                    </div>
				
            </div>
        </div>
        <hr class="clearfix">

        
        <!-- 是否加载使用自带的 prismjs. -->
        <link rel="stylesheet" href="/libs/prism/prism.min.css">
        

        
        <!-- 代码块折行 -->
        <style type="text/css">
            code[class*="language-"], pre[class*="language-"] { white-space: pre-wrap !important; }
        </style>
        

        <div class="card-content article-card-content">
            <div id="articleContent">
                <h1 id="K8S配置管理-ConfigMap和Sercret"><a href="#K8S配置管理-ConfigMap和Sercret" class="headerlink" title="K8S配置管理 ConfigMap和Sercret"></a>K8S配置管理 ConfigMap和Sercret</h1><h3 id="一、ConfigMap"><a href="#一、ConfigMap" class="headerlink" title="一、ConfigMap"></a><strong>一、ConfigMap</strong></h3><h4 id="1、ConfigMap的基本介绍"><a href="#1、ConfigMap的基本介绍" class="headerlink" title="1、ConfigMap的基本介绍"></a>1、ConfigMap的基本介绍</h4><pre class="language-latex" data-language="latex"><code class="language-latex">ConfigMap 是 Kubernetes 中的一种资源对象，用于存储应用程序的配置数据。它可以用于将配置信息与应用程序的 Pod 解耦，从而实现配置的动态管理和灵活性。
以下是 ConfigMap 的一些基本介绍和特点：
1、存储配置数据：ConfigMap 可以存储各种类型的配置数据，例如环境变量、命令行参数、配置文件等。它将配置数据以键值对的形式组织，并提供一个唯一的名称供应用程序使用。
2、解耦配置与应用程序：ConfigMap 允许将应用程序的配置从应用程序本身中分离出来，以实现配置和应用程序的解耦。这样，配置可以在不重启应用程序的情况下进行修改和更新，提供了更好的灵活性和可维护性
3、应用程序访问配置：应用程序可以通过环境变量、命令行参数或在容器内挂载配置文件的方式来访问 ConfigMap 中的配置数据。这使得应用程序可以在运行时动态地获取和使用配置信息。
4、容易管理和更新：ConfigMap 的配置数据可以通过命令行工具（如 kubectl）或使用Kubernetes 的 API 进行创建、更新和删除。这使得管理和更新配置变得简单和可扩展，可以与应用程序的部署和扩展自动化流程结合使用。
5、与 Pod 的关联：ConfigMap 可以与 Pod 进行关联，以便将配置数据传递给 Pod 中的容器。您可以通过将 ConfigMap 挂载为容器的卷（Volume）或设置容器的环境变量来实现配置的传递。
总而言之，ConfigMap 是 Kubernetes 中的一种资源对象，用于存储应用程序的配置数据。它通过解耦配置和应用程序，提供了配置的动态管理和灵活性。使用 ConfigMap，您可以轻松地管理和更新应用程序的配置，同时使配置与应用程序的部署和扩展过程解耦。</code></pre>

<h4 id="2、ConfigMap的创建方法"><a href="#2、ConfigMap的创建方法" class="headerlink" title="2、ConfigMap的创建方法"></a>2、ConfigMap的创建方法</h4><h6 id="1-直接在命令行创建"><a href="#1-直接在命令行创建" class="headerlink" title="1.直接在命令行创建"></a>1.直接在命令行创建</h6><pre class="language-yaml" data-language="yaml"><code class="language-yaml">kubectl create configmap nginx <span class="token punctuation">-</span><span class="token punctuation">-</span>from<span class="token punctuation">-</span>literal=tomcat_port=90 <span class="token punctuation">-</span><span class="token punctuation">-</span>from<span class="token punctuation">-</span>literal=server_name=myapp.nginx.com
kubectl describe configmap nginx
<span class="token key atrule">Name</span><span class="token punctuation">:</span>         nginx
<span class="token key atrule">Namespace</span><span class="token punctuation">:</span>    default
<span class="token key atrule">Labels</span><span class="token punctuation">:</span>       &lt;none<span class="token punctuation">&gt;</span>
<span class="token key atrule">Annotations</span><span class="token punctuation">:</span>  &lt;none<span class="token punctuation">&gt;</span>
Data
====
<span class="token key atrule">tomcat_port</span><span class="token punctuation">:</span>
<span class="token punctuation">---</span><span class="token punctuation">-</span>
<span class="token number">90</span>
<span class="token key atrule">server_name</span><span class="token punctuation">:</span>
<span class="token punctuation">---</span><span class="token punctuation">-</span>
myapp.nginx.com
BinaryData
====
<span class="token key atrule">Events</span><span class="token punctuation">:</span>  &lt;none<span class="token punctuation">&gt;</span></code></pre>

<h6 id="2-通过文件创建"><a href="#2-通过文件创建" class="headerlink" title="2.通过文件创建"></a>2.通过文件创建</h6><pre class="language-yaml" data-language="yaml"><code class="language-yaml">vim nginx.conf
server <span class="token punctuation">{</span>
 server_name www.nginx.com;
 listen 80;
<span class="token punctuation">}</span>
kubectl create configmap nginx <span class="token punctuation">-</span><span class="token punctuation">-</span>from<span class="token punctuation">-</span>file=www=./nginx.conf 
kubectl describe cm nginx
<span class="token key atrule">Name</span><span class="token punctuation">:</span>         nginx
<span class="token key atrule">Namespace</span><span class="token punctuation">:</span>    default
<span class="token key atrule">Labels</span><span class="token punctuation">:</span>       &lt;none<span class="token punctuation">&gt;</span>
<span class="token key atrule">Annotations</span><span class="token punctuation">:</span>  &lt;none<span class="token punctuation">&gt;</span>
Data
====
<span class="token key atrule">www</span><span class="token punctuation">:</span>
<span class="token punctuation">---</span><span class="token punctuation">-</span>
server <span class="token punctuation">{</span>
 server_name www.nginx.com;
 listen 80;
<span class="token punctuation">}</span>
BinaryData
====
<span class="token key atrule">Events</span><span class="token punctuation">:</span>  &lt;none<span class="token punctuation">&gt;</span></code></pre>

<h6 id="3-编写configmap"><a href="#3-编写configmap" class="headerlink" title="3.编写configmap"></a>3.编写configmap</h6><pre class="language-yaml" data-language="yaml"><code class="language-yaml">cat mysql<span class="token punctuation">-</span>cm.yaml 
<span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> ConfigMap
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> mysqlconfig
  <span class="token key atrule">labels</span><span class="token punctuation">:</span>
    <span class="token key atrule">app</span><span class="token punctuation">:</span> mysql
<span class="token key atrule">data</span><span class="token punctuation">:</span>
  <span class="token key atrule">mysqlConfig</span><span class="token punctuation">:</span> <span class="token string">'123'</span>
kubectl apply <span class="token punctuation">-</span>f mysql<span class="token punctuation">-</span>cm.yaml
kubectl describe cm mysqlconfig
<span class="token key atrule">Name</span><span class="token punctuation">:</span>         mysqlconfig
<span class="token key atrule">Namespace</span><span class="token punctuation">:</span>    default
<span class="token key atrule">Labels</span><span class="token punctuation">:</span>       app=mysql
<span class="token key atrule">Annotations</span><span class="token punctuation">:</span>  &lt;none<span class="token punctuation">&gt;</span>
Data
====
<span class="token key atrule">mysqlConfig</span><span class="token punctuation">:</span>
<span class="token punctuation">---</span><span class="token punctuation">-</span>
<span class="token number">123</span>
BinaryData
====
<span class="token key atrule">Events</span><span class="token punctuation">:</span>  &lt;none<span class="token punctuation">&gt;</span></code></pre>

<h4 id="3、使用ConfigMap"><a href="#3、使用ConfigMap" class="headerlink" title="3、使用ConfigMap"></a>3、使用ConfigMap</h4><h5 id="1-通过环境变量引入-单个"><a href="#1-通过环境变量引入-单个" class="headerlink" title="1.通过环境变量引入(单个)"></a>1.通过环境变量引入(单个)</h5><pre class="language-yaml" data-language="yaml"><code class="language-yaml">
创建一个存储MySQL配置的configmap
cat mysql.yaml 
<span class="token punctuation">---</span>
<span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> ConfigMap
<span class="token key atrule">data</span><span class="token punctuation">:</span>
  <span class="token key atrule">log</span><span class="token punctuation">:</span> <span class="token string">"1"</span>
  <span class="token key atrule">lower</span><span class="token punctuation">:</span> <span class="token string">"1"</span>
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> mysql<span class="token punctuation">-</span>config
  <span class="token key atrule">labels</span><span class="token punctuation">:</span>
    <span class="token key atrule">app</span><span class="token punctuation">:</span> mysql
创建pod引用Configmap中的内容
cat mysql<span class="token punctuation">-</span>pod.yaml 
<span class="token punctuation">---</span>
<span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> Pod
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> mysqlpod
  <span class="token key atrule">labels</span><span class="token punctuation">:</span>
    <span class="token key atrule">app</span><span class="token punctuation">:</span> mysql
<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">containers</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> mysql
    <span class="token key atrule">image</span><span class="token punctuation">:</span> busybox
    <span class="token key atrule">command</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">"/bin/sh"</span><span class="token punctuation">,</span><span class="token string">"-c"</span><span class="token punctuation">,</span><span class="token string">"sleep 3600"</span><span class="token punctuation">]</span>
    <span class="token key atrule">env</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> log_bin    <span class="token comment">#定义环境变量log_bin</span>
      <span class="token key atrule">valueFrom</span><span class="token punctuation">:</span>
        <span class="token key atrule">configMapKeyRef</span><span class="token punctuation">:</span> 
          <span class="token key atrule">name</span><span class="token punctuation">:</span> mysql<span class="token punctuation">-</span>config    <span class="token comment">#指定configMap的名字</span>
          <span class="token key atrule">key</span><span class="token punctuation">:</span> log              <span class="token comment">#指定ConfigMap中的key</span>
    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> lower      <span class="token comment">#定义环境变量lower</span>
      <span class="token key atrule">valueFrom</span><span class="token punctuation">:</span>
        <span class="token key atrule">configMapKeyRef</span><span class="token punctuation">:</span>
          <span class="token key atrule">name</span><span class="token punctuation">:</span> mysql<span class="token punctuation">-</span>config    <span class="token comment">#指定configMap的名字</span>
          <span class="token key atrule">key</span><span class="token punctuation">:</span> lower            <span class="token comment">#指定ConfigMap中的key</span>
进入pod
kubectl exec mysqlpod  <span class="token punctuation">-</span>it <span class="token punctuation">-</span><span class="token punctuation">-</span> /bin/sh
查看环境变量是否存在
/ <span class="token comment"># printenv | grep lower</span>
lower=1
/ <span class="token comment"># printenv | grep log</span>
log_bin=1</code></pre>

<h5 id="2-通过环境变量引入-整个configmap"><a href="#2-通过环境变量引入-整个configmap" class="headerlink" title="2.通过环境变量引入(整个configmap)"></a>2.通过环境变量引入(整个configmap)</h5><pre class="language-yaml" data-language="yaml"><code class="language-yaml">
cat mysql<span class="token punctuation">-</span>pod.yaml 
<span class="token punctuation">---</span>
<span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> Pod
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> mysqlpod
  <span class="token key atrule">labels</span><span class="token punctuation">:</span>
    <span class="token key atrule">app</span><span class="token punctuation">:</span> mysql
<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">containers</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> mysql
    <span class="token key atrule">image</span><span class="token punctuation">:</span> busybox
    <span class="token key atrule">command</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">"/bin/sh"</span><span class="token punctuation">,</span><span class="token string">"-c"</span><span class="token punctuation">,</span><span class="token string">"sleep 3600"</span><span class="token punctuation">]</span>
    <span class="token key atrule">envFrom</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token key atrule">configMapRef</span><span class="token punctuation">:</span>
        <span class="token key atrule">name</span><span class="token punctuation">:</span> mysql<span class="token punctuation">-</span>config
  <span class="token key atrule">restartPolicy</span><span class="token punctuation">:</span> Never
测试：
kubectl exec mysqlpod  <span class="token punctuation">-</span>it <span class="token punctuation">-</span><span class="token punctuation">-</span> /bin/sh
/ <span class="token comment"># printenv | grep log</span>
log=1
/ <span class="token comment"># printenv | grep lower</span>
lower=1
/ <span class="token comment"># exit</span></code></pre>

<h5 id="3-把ConfigMap做成volume，挂载到Pod"><a href="#3-把ConfigMap做成volume，挂载到Pod" class="headerlink" title="3.把ConfigMap做成volume，挂载到Pod"></a>3.把ConfigMap做成volume，挂载到Pod</h5><pre class="language-yaml" data-language="yaml"><code class="language-yaml">
创建ConfigMap
cat mysql<span class="token punctuation">-</span>1.yaml 
<span class="token punctuation">---</span>
<span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> ConfigMap
<span class="token key atrule">data</span><span class="token punctuation">:</span>
  <span class="token key atrule">log</span><span class="token punctuation">:</span> <span class="token string">"1"</span>
  <span class="token key atrule">lower</span><span class="token punctuation">:</span> <span class="token string">"1"</span>
  <span class="token key atrule">my.cnf</span><span class="token punctuation">:</span> <span class="token punctuation">|</span><span class="token scalar string">
    [mysqld]
    Welcome=IW</span>
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> mysql<span class="token punctuation">-</span><span class="token number">1</span>
  <span class="token key atrule">labels</span><span class="token punctuation">:</span>
    <span class="token key atrule">app</span><span class="token punctuation">:</span> mysql
创建Pod
cat mysql<span class="token punctuation">-</span>pod<span class="token punctuation">-</span>volume.yaml 
<span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> Pod
<span class="token key atrule">metadata</span><span class="token punctuation">:</span> 
  <span class="token key atrule">name</span><span class="token punctuation">:</span> mysql<span class="token punctuation">-</span>pod<span class="token punctuation">-</span>volume
  <span class="token key atrule">labels</span><span class="token punctuation">:</span>
    <span class="token key atrule">name</span><span class="token punctuation">:</span> mysql<span class="token punctuation">-</span>pod<span class="token punctuation">-</span>volume
<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">containers</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> mysql
    <span class="token key atrule">image</span><span class="token punctuation">:</span> busybox
    <span class="token key atrule">command</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">"/bin/sh"</span><span class="token punctuation">,</span><span class="token string">"-c"</span><span class="token punctuation">,</span><span class="token string">"sleep 3600"</span><span class="token punctuation">]</span>
    <span class="token key atrule">volumeMounts</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> mysql<span class="token punctuation">-</span>config
      <span class="token key atrule">mountPath</span><span class="token punctuation">:</span> /tmp/config
  <span class="token key atrule">volumes</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> mysql<span class="token punctuation">-</span>config
    <span class="token key atrule">configMap</span><span class="token punctuation">:</span> 
      <span class="token key atrule">name</span><span class="token punctuation">:</span> mysql<span class="token punctuation">-</span><span class="token number">1</span>
  <span class="token key atrule">restartPolicy</span><span class="token punctuation">:</span> Never
测试：
kubectl exec mysql<span class="token punctuation">-</span>pod<span class="token punctuation">-</span>volume  <span class="token punctuation">-</span>it <span class="token punctuation">-</span><span class="token punctuation">-</span> /bin/sh
/ <span class="token comment"># ls /tmp/config/</span>
log     lower   my.cnf
/ <span class="token comment"># cat /tmp/config/log </span>
/ <span class="token comment"># cat /tmp/config/log </span>
1/ <span class="token comment"># </span>
/ <span class="token comment"># cat /tmp/config/lower </span>
1/ <span class="token comment"># </span>
/ <span class="token comment"># cat /tmp/config/my.cnf  </span>
<span class="token punctuation">[</span>mysqld<span class="token punctuation">]</span>
Welcome=IW</code></pre>

<h4 id="4、ConfigMap热更新"><a href="#4、ConfigMap热更新" class="headerlink" title="4、ConfigMap热更新"></a>4、ConfigMap热更新</h4><pre class="language-yaml" data-language="yaml"><code class="language-yaml">
kubectl edit cm mysql<span class="token punctuation">-</span><span class="token number">1</span>
<span class="token comment"># Please edit the object below. Lines beginning with a '#' will be ignored,</span>
<span class="token comment"># and an empty file will abort the edit. If an error occurs while saving this file will be</span>
<span class="token comment"># reopened with the relevant failures.</span>
<span class="token comment">#</span>
<span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> v1
<span class="token key atrule">data</span><span class="token punctuation">:</span>
  <span class="token key atrule">log</span><span class="token punctuation">:</span> <span class="token string">"2"</span>         <span class="token comment">#这里将1修改为2</span>
  <span class="token key atrule">lower</span><span class="token punctuation">:</span> <span class="token string">"1"</span>
  <span class="token key atrule">my.cnf</span><span class="token punctuation">:</span> <span class="token punctuation">|</span><span class="token scalar string">
    [mysqld]
    Welcome=IW</span>
<span class="token key atrule">kind</span><span class="token punctuation">:</span> ConfigMap
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">annotations</span><span class="token punctuation">:</span>
    <span class="token key atrule">kubectl.kubernetes.io/last-applied-configuration</span><span class="token punctuation">:</span> <span class="token punctuation">|</span><span class="token scalar string">
      {"apiVersion":"v1","data":{"log":"1","lower":"1","my.cnf":"[mysqld]\nWelcome=liangxi\n"},"kind":"ConfigMap","metadata":{"annotations":{},"labels":{"app":"mysql"},"name":"mysql-1","namespace":"default"}}</span>
  <span class="token key atrule">creationTimestamp</span><span class="token punctuation">:</span> <span class="token string">"2024-03-01T07:19:22Z"</span>
  <span class="token key atrule">labels</span><span class="token punctuation">:</span>
    <span class="token key atrule">app</span><span class="token punctuation">:</span> mysql
  <span class="token key atrule">name</span><span class="token punctuation">:</span> mysql<span class="token punctuation">-</span><span class="token number">1</span>
  <span class="token key atrule">namespace</span><span class="token punctuation">:</span> default
  <span class="token key atrule">resourceVersion</span><span class="token punctuation">:</span> <span class="token string">"435348"</span>
  <span class="token key atrule">uid</span><span class="token punctuation">:</span> 9c5plc69<span class="token punctuation">-</span>7249<span class="token punctuation">-</span>3786<span class="token punctuation">-</span>b756<span class="token punctuation">-</span>3344ddjgmbc5
<span class="token key atrule">测试</span><span class="token punctuation">:</span>
cat /tmp/config/log 
2

<span class="token comment">#####注意######</span>
更新 ConfigMap 后：
使用该 ConfigMap 挂载的 Env 不会同步更新
使用该 ConfigMap 挂载的 Volume 中的数据需要一段时间（实测大概 10 秒）才能同步更新
ENV 是在容器启动的时候注入的，启动之后 kubernetes 就不会再改变环境变量的值，且同一个namespace 中的 pod 的环境变量是不断累加的，为了更新容器中使用 ConfigMap 挂载的配置，可以通过滚动更新 pod 的方式来强制重新挂载 ConfigMap，也可以在更新了 ConfigMap 后，先将副本数设置为 0，再扩容 pod</code></pre>

<h3 id="二、Secret"><a href="#二、Secret" class="headerlink" title="二、Secret"></a>二、Secret</h3><h4 id="1-Secret描述"><a href="#1-Secret描述" class="headerlink" title="1.Secret描述"></a>1.Secret描述</h4><pre class="language-latex" data-language="latex"><code class="language-latex">Kubernetes (k8s) Secrets 是 Kubernetes 集群中的一种资源对象，用于存储和管理敏感信息，例如密码、令牌、API 密钥和证书等。
Kubernetes Secrets 的主要目的是将敏感数据与应用程序代码分离，并提供一种安全的方式来存储和传递这些敏感数据给容器化的应用程序。它们以加密的形式保存，并且只能在需要时才能被解密和使用。
以下是关于 Kubernetes Secrets 的一些基本特点和用法：
1、类型：Kubernetes Secrets 可以存储任意字节的数据，但通常用于存储字符串格式的敏感信息。
2、创建和管理：可以使用 Kubernetes 命令行工具（kubectl）或 Kubernetes API 来创建和管理Secrets。
3、加密和解密：Kubernetes Secrets 会将存储的敏感数据加密，并使用 Base64 编码进行存储。在使用 Secrets 时，Kubernetes 会自动将其解码并将解密的值提供给应用程序。
4、Secret 类型：Kubernetes 提供了几种不同的 Secret 类型，包括：
1）Opaque：适用于存储任意类型的敏感数据，默认情况下以 Base64 编码进行存储。
2）Service Account：用于将 Pod 与 Service Account 关联，并将 Service Account 的 Token注入到 Pod 中，以便 Pod 可以与 Kubernetes API 进行交互。
3）Docker Registry：用于存储与私有 Docker 注册表的认证信息，以便 Kubernetes 可以拉取私有镜像。
4）TLS：用于存储 TLS 证书和私钥。
5、使用 Secrets：在 Kubernetes 中使用 Secrets 时，可以通过环境变量、挂载文件或通过卷的方式将其传递给 Pod 中的应用程序。
1）环境变量：可以将 Secret 的值作为环境变量传递给应用程序。
2）挂载文件：可以将 Secret 中的值以文件的形式挂载到 Pod 中，应用程序可以读取这些文件。
3）通过卷：可以将 Secret 中的值作为卷挂载到 Pod 中，应用程序可以从该卷中读取敏感数据。
Kubernetes Secrets 提供了一种安全和可扩展的方式来管理敏感数据，并帮助将敏感信息与应用程序代码分离，从而更好地保护应用程序和集群的安全性。</code></pre>

<h4 id="2-Secret的创建方式"><a href="#2-Secret的创建方式" class="headerlink" title="2.Secret的创建方式"></a>2.Secret的创建方式</h4><h5 id="1-通过命令行创建Secret"><a href="#1-通过命令行创建Secret" class="headerlink" title="1.通过命令行创建Secret"></a>1.通过命令行创建Secret</h5><pre class="language-yaml" data-language="yaml"><code class="language-yaml">
kubectl create secret generic mysql<span class="token punctuation">-</span>password <span class="token punctuation">-</span><span class="token punctuation">-</span>from<span class="token punctuation">-</span>literal=password=1
kubectl describe secret mysql<span class="token punctuation">-</span>password
<span class="token key atrule">Name</span><span class="token punctuation">:</span>         mysql<span class="token punctuation">-</span>password
<span class="token key atrule">Namespace</span><span class="token punctuation">:</span>    default
<span class="token key atrule">Labels</span><span class="token punctuation">:</span>       &lt;none<span class="token punctuation">&gt;</span>
<span class="token key atrule">Annotations</span><span class="token punctuation">:</span>  &lt;none<span class="token punctuation">&gt;</span>
<span class="token key atrule">Type</span><span class="token punctuation">:</span>  Opaque
Data
====
<span class="token key atrule">password</span><span class="token punctuation">:</span>  7 bytes</code></pre>

<h5 id="2-编写yaml文件"><a href="#2-编写yaml文件" class="headerlink" title="2.编写yaml文件"></a>2.编写yaml文件</h5><pre class="language-yaml" data-language="yaml"><code class="language-yaml">手动加密，基于base64加密
<span class="token punctuation">[</span>root@master configmap<span class="token punctuation">]</span><span class="token comment"># echo -n 'admin' | base64</span>
YWRtaW4=
<span class="token punctuation">[</span>root@master configmap<span class="token punctuation">]</span><span class="token comment"># echo -n '1' | base64</span>
MQ==
解码：
<span class="token punctuation">[</span>root@master configmap<span class="token punctuation">]</span><span class="token comment"># echo MQ== | base64 -d</span>
1
编写yaml文件
cat secret.yaml 
<span class="token punctuation">---</span>
<span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> Secret
<span class="token key atrule">data</span><span class="token punctuation">:</span>
  <span class="token key atrule">username</span><span class="token punctuation">:</span> YWRtaW4=
  <span class="token key atrule">password</span><span class="token punctuation">:</span> MQ==
<span class="token key atrule">type</span><span class="token punctuation">:</span> Opaque
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> secret
查看资源详细信息
kubectl describe secret secret
<span class="token key atrule">Name</span><span class="token punctuation">:</span>         secret
<span class="token key atrule">Namespace</span><span class="token punctuation">:</span>    default
<span class="token key atrule">Labels</span><span class="token punctuation">:</span>       &lt;none<span class="token punctuation">&gt;</span>
<span class="token key atrule">Annotations</span><span class="token punctuation">:</span>  &lt;none<span class="token punctuation">&gt;</span>
<span class="token key atrule">Type</span><span class="token punctuation">:</span>  Opaque
Data
====
<span class="token key atrule">password</span><span class="token punctuation">:</span>  1 bytes
<span class="token key atrule">username</span><span class="token punctuation">:</span>  5 bytes</code></pre>

<h4 id="3-使用secret"><a href="#3-使用secret" class="headerlink" title="3.使用secret"></a>3.使用secret</h4><h5 id="1-通过环境变量引入"><a href="#1-通过环境变量引入" class="headerlink" title="1.通过环境变量引入"></a>1.通过环境变量引入</h5><pre class="language-yaml" data-language="yaml"><code class="language-yaml">cat pod<span class="token punctuation">-</span>secret.yaml 
<span class="token punctuation">---</span>
<span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> Pod
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> pod<span class="token punctuation">-</span>secert
<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">containers</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> myapp
    <span class="token key atrule">image</span><span class="token punctuation">:</span> busybox
    <span class="token key atrule">command</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">"/bin/sh"</span><span class="token punctuation">,</span><span class="token string">"-c"</span><span class="token punctuation">,</span><span class="token string">"sleep 3600"</span><span class="token punctuation">]</span>
    <span class="token key atrule">env</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> MYSQL_ROOT_PASSWORD
      <span class="token key atrule">valueFrom</span><span class="token punctuation">:</span>
        <span class="token key atrule">secretKeyRef</span><span class="token punctuation">:</span>
          <span class="token key atrule">name</span><span class="token punctuation">:</span> mysql<span class="token punctuation">-</span>password
          <span class="token key atrule">key</span><span class="token punctuation">:</span> password
测试：
kubectl exec <span class="token punctuation">-</span>it pod<span class="token punctuation">-</span>secert <span class="token punctuation">-</span><span class="token punctuation">-</span> /bin/sh
/ <span class="token comment"># printenv | grep MYSQL</span>
MYSQL_ROOT_PASSWORD=1</code></pre>

<h5 id="2-通过volume挂载Secret"><a href="#2-通过volume挂载Secret" class="headerlink" title="2.通过volume挂载Secret"></a>2.通过volume挂载Secret</h5><pre class="language-yaml" data-language="yaml"><code class="language-yaml">cat pod_secret_volume.yaml 
<span class="token punctuation">---</span>
<span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> Pod
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> pod<span class="token punctuation">-</span>secret<span class="token punctuation">-</span>volume
<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">containers</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> myapp
    <span class="token key atrule">image</span><span class="token punctuation">:</span> busybox
    <span class="token key atrule">command</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">"/bin/sh"</span><span class="token punctuation">,</span><span class="token string">"-c"</span><span class="token punctuation">,</span><span class="token string">"sleep 3600"</span><span class="token punctuation">]</span>
    <span class="token key atrule">volumeMounts</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> secret<span class="token punctuation">-</span>volume
      <span class="token key atrule">mountPath</span><span class="token punctuation">:</span> /etc/secret
      <span class="token key atrule">readOnly</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
  <span class="token key atrule">volumes</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> secret<span class="token punctuation">-</span>volume
    <span class="token key atrule">secret</span><span class="token punctuation">:</span>
      <span class="token key atrule">secretName</span><span class="token punctuation">:</span> secret
测试：
kubectl exec <span class="token punctuation">-</span>it pod<span class="token punctuation">-</span>secret<span class="token punctuation">-</span>volume <span class="token punctuation">-</span><span class="token punctuation">-</span> /bin/sh
/ <span class="token comment"># ls /etc/secret/</span>
..2024_03_01_09_21_27.3393208461/  password
..data/                            username
/ <span class="token comment"># cat /etc/secret/password </span>
1/ <span class="token comment"># </span>
/ <span class="token comment"># </span>
/ <span class="token comment"># cat /etc/secret/username </span>
admin/ <span class="token comment"># </span></code></pre>


                
            </div>
            <hr/>

            

    <div class="reprint" id="reprint-statement">
        
            <div class="reprint__author">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-user">
                        文章作者:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="/about" rel="external nofollow noreferrer">IW</a>
                </span>
            </div>
            <div class="reprint__type">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-link">
                        文章链接:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="https://iwhig.github.io/2024/03/05/k8s-pei-zhi-guan-li-configmap-he-sercret/">https://iwhig.github.io/2024/03/05/k8s-pei-zhi-guan-li-configmap-he-sercret/</a>
                </span>
            </div>
            <div class="reprint__notice">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-copyright">
                        版权声明:
                    </i>
                </span>
                <span class="reprint-info">
                    本博客所有文章除特別声明外，均采用
                    <a href="https://creativecommons.org/licenses/by/4.0/deed.zh" rel="external nofollow noreferrer" target="_blank">CC BY 4.0</a>
                    许可协议。转载请注明来源
                    <a href="/about" target="_blank">IW</a>
                    !
                </span>
            </div>
        
    </div>

    <script async defer>
      document.addEventListener("copy", function (e) {
        let toastHTML = '<span>复制成功，请遵循本文的转载规则</span><button class="btn-flat toast-action" onclick="navToReprintStatement()" style="font-size: smaller">查看</a>';
        M.toast({html: toastHTML})
      });

      function navToReprintStatement() {
        $("html, body").animate({scrollTop: $("#reprint-statement").offset().top - 80}, 800);
      }
    </script>



            <div class="tag_share" style="display: block;">
                <div class="post-meta__tag-list" style="display: inline-block;">
                    
                        <div class="article-tag">
                            
                                <a href="/tags/Linux/">
                                    <span class="chip bg-color">Linux</span>
                                </a>
                            
                                <a href="/tags/Shell/">
                                    <span class="chip bg-color">Shell</span>
                                </a>
                            
                                <a href="/tags/Kubernetes/">
                                    <span class="chip bg-color">Kubernetes</span>
                                </a>
                            
                        </div>
                    
                </div>
                <div class="post_share" style="zoom: 80%; width: fit-content; display: inline-block; float: right; margin: -0.15rem 0;">
                    <link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css">
<div id="article-share">

    
    <div class="social-share" data-sites="twitter,facebook,google,qq,qzone,wechat,weibo,douban,linkedin" data-wechat-qrcode-helper="<p>微信扫一扫即可分享！</p>"></div>
    <script src="/libs/share/js/social-share.min.js"></script>
    

    

</div>

                </div>
            </div>
            
        </div>
    </div>

    

    

    

    

    

    

    

    

    

<article id="prenext-posts" class="prev-next articles">
    <div class="row article-row">
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge left-badge text-color">
                <i class="fas fa-chevron-left"></i>&nbsp;上一篇</div>
            <div class="card">
                <a href="/2024/03/11/awk-ru-men-dao-fang-qi/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/13.jpg" class="responsive-img" alt="Awk入门到放弃">
                        
                        <span class="card-title">Awk入门到放弃</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            
                        
                    </div>
                    <div class="publish-info">
                        <span class="publish-date">
                            <i class="far fa-clock fa-fw icon-date"></i>2024-03-11
                        </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/deploy/" class="post-category">
                                    deploy
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/Linux/">
                        <span class="chip bg-color">Linux</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge right-badge text-color">
                下一篇&nbsp;<i class="fas fa-chevron-right"></i>
            </div>
            <div class="card">
                <a href="/2024/02/06/harbor-bu-shu-zi-qian-zheng-shu/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/21.jpg" class="responsive-img" alt="Harbor部署及自签证书">
                        
                        <span class="card-title">Harbor部署及自签证书</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            容器镜像仓库部署，证书自签避免docker登录仓库时提示仓库不安全
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="far fa-clock fa-fw icon-date"></i>2024-02-06
                            </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/deploy/" class="post-category">
                                    deploy
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/Docker/">
                        <span class="chip bg-color">Docker</span>
                    </a>
                    
                    <a href="/tags/Deploy/">
                        <span class="chip bg-color">Deploy</span>
                    </a>
                    
                    <a href="/tags/Container/">
                        <span class="chip bg-color">Container</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
    </div>
</article>

</div>



<!-- 代码块功能依赖 -->
<script type="text/javascript" src="/libs/codeBlock/codeBlockFuction.js"></script>


  <!-- 是否加载使用自带的 prismjs. -->
  <script type="text/javascript" src="/libs/prism/prism.min.js"></script>


<!-- 代码语言 -->

<script type="text/javascript" src="/libs/codeBlock/codeLang.js"></script>


<!-- 代码块复制 -->

<script type="text/javascript" src="/libs/codeBlock/codeCopy.js"></script>


<!-- 代码块收缩 -->

<script type="text/javascript" src="/libs/codeBlock/codeShrink.js"></script>



    </div>
    <div id="toc-aside" class="expanded col l3 hide-on-med-and-down">
        <div class="toc-widget card" style="background-color: white;">
            <div class="toc-title"><i class="far fa-list-alt"></i>&nbsp;&nbsp;目录</div>
            <div id="toc-content"></div>
        </div>
    </div>
</div>

<!-- TOC 悬浮按钮. -->

<div id="floating-toc-btn" class="hide-on-med-and-down">
    <a class="btn-floating btn-large bg-color">
        <i class="fas fa-list-ul"></i>
    </a>
</div>


<script src="/libs/tocbot/tocbot.min.js"></script>
<script>
    $(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '#articleContent',
            headingsOffset: -($(window).height() * 0.4 - 45),
            collapseDepth: Number('0'),
            headingSelector: 'h2, h3, h4'
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });

        
        /* 修复文章卡片 div 的宽度. */
        let fixPostCardWidth = function (srcId, targetId) {
            let srcDiv = $('#' + srcId);
            if (srcDiv.length === 0) {
                return;
            }

            let w = srcDiv.width();
            if (w >= 450) {
                w = w + 21;
            } else if (w >= 350 && w < 450) {
                w = w + 18;
            } else if (w >= 300 && w < 350) {
                w = w + 16;
            } else {
                w = w + 14;
            }
            $('#' + targetId).width(w);
        };

        // 切换TOC目录展开收缩的相关操作.
        const expandedClass = 'expanded';
        let $tocAside = $('#toc-aside');
        let $mainContent = $('#main-content');
        $('#floating-toc-btn .btn-floating').click(function () {
            if ($tocAside.hasClass(expandedClass)) {
                $tocAside.removeClass(expandedClass).hide();
                $mainContent.removeClass('l9');
            } else {
                $tocAside.addClass(expandedClass).show();
                $mainContent.addClass('l9');
            }
            fixPostCardWidth('artDetail', 'prenext-posts');
        });
        
    });
</script>

    

</main>




    <footer class="page-footer bg-color">
    
        <link rel="stylesheet" href="/libs/aplayer/APlayer.min.css">
<style>
    .aplayer .aplayer-lrc p {
        
        display: none;
        
        font-size: 12px;
        font-weight: 700;
        line-height: 16px !important;
    }

    .aplayer .aplayer-lrc p.aplayer-lrc-current {
        
        display: none;
        
        font-size: 15px;
        color: #42b983;
    }

    
    .aplayer.aplayer-fixed.aplayer-narrow .aplayer-body {
        left: -66px !important;
    }

    .aplayer.aplayer-fixed.aplayer-narrow .aplayer-body:hover {
        left: 0px !important;
    }

    
</style>
<div class="">
    
    <div class="row">
        <meting-js class="col l8 offset-l2 m10 offset-m1 s12"
                   server="netease"
                   type="playlist"
                   id="503838841"
                   fixed='true'
                   autoplay='false'
                   theme='#42b983'
                   loop='all'
                   order='random'
                   preload='auto'
                   volume='0.7'
                   list-folded='true'
        >
        </meting-js>
    </div>
</div>

<script src="/libs/aplayer/APlayer.min.js"></script>
<script src="/libs/aplayer/Meting.min.js"></script>

    

    <div class="container row center-align"
         style="margin-bottom: 0px !important;">
        <div class="col s12 m8 l8 copy-right">
            Copyright&nbsp;&copy;
            
                <span id="year">2023-2024</span>
            
            <a href="/about" target="_blank">I W</a>
            |&nbsp;Powered by&nbsp;<a href="https://hexo.io/" target="_blank">Hexo</a>
            |&nbsp;Theme&nbsp;<a href="https://github.com/blinkfox/hexo-theme-matery" target="_blank">Matery</a>
            
                <span id="translate">|&nbsp;繁/简：</span><a id="translateLink" href="javascript:translatePage();">繁</a>
            
            <br>
            
                &nbsp;<i class="fas fa-chart-area"></i>&nbsp;站点总字数:&nbsp;<span
                        class="white-color">45.9k</span>
            
            
            
                
            
            
                <span id="busuanzi_container_site_pv">
                &nbsp;|&nbsp;<i class="far fa-eye"></i>&nbsp;总访问量:&nbsp;
                    <span id="busuanzi_value_site_pv" class="white-color"></span>
            </span>
            
            
                <span id="busuanzi_container_site_uv">
                &nbsp;|&nbsp;<i class="fas fa-users"></i>&nbsp;总访问人数:&nbsp;
                    <span id="busuanzi_value_site_uv" class="white-color"></span>
            </span>
            
            <br>

            <!-- 运行天数提醒. -->
            
            <br>
            
        </div>
        <div class="col s12 m4 l4 social-link social-statis">
    <a href="https://github.com/iwhig" class="tooltipped" target="_blank" data-tooltip="访问我的GitHub" data-position="top" data-delay="50">
        <i class="fab fa-github"></i>
    </a>



    <a href="mailto:zzjmcloud@outlook.com" class="tooltipped" target="_blank" data-tooltip="邮件联系我" data-position="top" data-delay="50">
        <i class="fas fa-envelope-open"></i>
    </a>







    <a href="tencent://AddContact/?fromId=50&fromSubId=1&subcmd=all&uin=2632440423" class="tooltipped" target="_blank" data-tooltip="QQ联系我: 2632440423" data-position="top" data-delay="50">
        <i class="fab fa-qq"></i>
    </a>







</div>
    </div>
</footer>

<div class="progress-bar"></div>


    <!-- 搜索遮罩框 -->
<div id="searchModal" class="modal">
    <div class="modal-content">
        <div class="search-header">
            <span class="title"><i class="fas fa-search"></i>&nbsp;&nbsp;搜索</span>
            <input type="search" id="searchInput" name="s" placeholder="请输入搜索的关键字"
                   class="search-input">
        </div>
        <div id="searchResult"></div>
    </div>
</div>

<script type="text/javascript">
$(function () {
    var searchFunc = function (path, search_id, content_id) {
        'use strict';
        $.ajax({
            url: path,
            dataType: "xml",
            success: function (xmlResponse) {
                // get the contents from search data
                var datas = $("entry", xmlResponse).map(function () {
                    return {
                        title: $("title", this).text(),
                        content: $("content", this).text(),
                        url: $("url", this).text()
                    };
                }).get();
                var $input = document.getElementById(search_id);
                var $resultContent = document.getElementById(content_id);
                $input.addEventListener('input', function () {
                    var str = '<ul class=\"search-result-list\">';
                    var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                    $resultContent.innerHTML = "";
                    if (this.value.trim().length <= 0) {
                        return;
                    }
                    // perform local searching
                    datas.forEach(function (data) {
                        var isMatch = true;
                        var data_title = data.title.trim().toLowerCase();
                        var data_content = data.content.trim().replace(/<[^>]+>/g, "").toLowerCase();
                        var data_url = data.url;
                        data_url = data_url.indexOf('/') === 0 ? data.url : '/' + data_url;
                        var index_title = -1;
                        var index_content = -1;
                        var first_occur = -1;
                        // only match artiles with not empty titles and contents
                        if (data_title !== '' && data_content !== '') {
                            keywords.forEach(function (keyword, i) {
                                index_title = data_title.indexOf(keyword);
                                index_content = data_content.indexOf(keyword);
                                if (index_title < 0 && index_content < 0) {
                                    isMatch = false;
                                } else {
                                    if (index_content < 0) {
                                        index_content = 0;
                                    }
                                    if (i === 0) {
                                        first_occur = index_content;
                                    }
                                }
                            });
                        }
                        // show search results
                        if (isMatch) {
                            str += "<li><a href='" + data_url + "' class='search-result-title'>" + data_title + "</a>";
                            var content = data.content.trim().replace(/<[^>]+>/g, "");
                            if (first_occur >= 0) {
                                // cut out 100 characters
                                var start = first_occur - 20;
                                var end = first_occur + 80;
                                if (start < 0) {
                                    start = 0;
                                }
                                if (start === 0) {
                                    end = 100;
                                }
                                if (end > content.length) {
                                    end = content.length;
                                }
                                var match_content = content.substr(start, end);
                                // highlight all keywords
                                keywords.forEach(function (keyword) {
                                    var regS = new RegExp(keyword, "gi");
                                    match_content = match_content.replace(regS, "<em class=\"search-keyword\">" + keyword + "</em>");
                                });

                                str += "<p class=\"search-result\">" + match_content + "...</p>"
                            }
                            str += "</li>";
                        }
                    });
                    str += "</ul>";
                    $resultContent.innerHTML = str;
                });
            }
        });
    };

    searchFunc('/search.xml', 'searchInput', 'searchResult');
});
</script>

    <!-- 白天和黑夜主题 -->
<div class="stars-con">
    <div id="stars"></div>
    <div id="stars2"></div>
    <div id="stars3"></div>  
</div>

<script>
    function switchNightMode() {
        $('<div class="Cuteen_DarkSky"><div class="Cuteen_DarkPlanet"></div></div>').appendTo($('body')),
        setTimeout(function () {
            $('body').hasClass('DarkMode') 
            ? ($('body').removeClass('DarkMode'), localStorage.setItem('isDark', '0'), $('#sum-moon-icon').removeClass("fa-sun").addClass('fa-moon')) 
            : ($('body').addClass('DarkMode'), localStorage.setItem('isDark', '1'), $('#sum-moon-icon').addClass("fa-sun").removeClass('fa-moon')),
            
            setTimeout(function () {
            $('.Cuteen_DarkSky').fadeOut(1e3, function () {
                $(this).remove()
            })
            }, 2e3)
        })
    }
</script>

    <!-- 回到顶部按钮 -->
<div id="backTop" class="top-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#!">
        <i class="fas fa-arrow-up"></i>
    </a>
</div>


    <script src="/libs/materialize/materialize.min.js"></script>
    <script src="/libs/masonry/masonry.pkgd.min.js"></script>
    <script src="/libs/aos/aos.js"></script>
    <script src="/libs/scrollprogress/scrollProgress.min.js"></script>
    <script src="/libs/lightGallery/js/lightgallery-all.min.js"></script>
    <script src="/js/matery.js"></script>

    

    
        <script type="text/javascript" src="/js/tw_cn.js"></script>
        <script type="text/javascript">
          var defaultEncoding = 2; //网站编写字体是否繁体，1-繁体，2-简体
          var translateDelay = 0; //延迟时间,若不在前, 要设定延迟翻译时间, 如100表示100ms,默认为0
          var cookieDomain = "https://iwhig.github.io"; //Cookie地址, 一定要设定, 通常为你的网址
          var msgToTraditionalChinese = "繁"; //此处可以更改为你想要显示的文字
          var msgToSimplifiedChinese = "简"; //同上，但两处均不建议更改
          var translateButtonId = "translateLink"; //默认互换id
          translateInitilization();
        </script>
    
    
    

    <!-- 雪花特效 -->
    

    <!-- 鼠标星星特效 -->
    

     
        <script src="https://ssl.captcha.qq.com/TCaptcha.js"></script>
        <script src="/libs/others/TencentCaptcha.js"></script>
        <button id="TencentCaptcha" data-appid="xxxxxxxxxx" data-cbfn="callback" type="button" hidden></button>
    

    <!-- Baidu Analytics -->

    <!-- Baidu Push -->

<script>
    (function () {
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        } else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
</script>

    
    <script src="/libs/others/clicklove.js" async="async"></script>
    
    
    <script async src="/libs/others/busuanzi.pure.mini.js"></script>
    

    

    

    <!--腾讯兔小巢-->
    
    

    

    

    
    <script src="/libs/instantpage/instantpage.js" type="module"></script>
    

</body>

</html>
